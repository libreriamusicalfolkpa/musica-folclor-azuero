<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Autor | Repositorio Musical de Azuero</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/estilos.css">
</head>
<body>

<header>
  <h1>Autor</h1>
<nav>
  <a href="index.html" class="btn">Inicio</a>
  <a href="contacto.html" class="btn">Contacto</a>
  <a href="disclaimer.html" class="btn">Disclaimer</a>
</nav>
</header>

<main id="autor-detalle"></main>

<!-- Modal para imagen del autor -->
<div id="modal-imagen" class="modal">
  <span class="modal-cerrar" id="cerrar-modal">&times;</span>
  <img class="modal-contenido" id="modal-img" alt="Imagen del autor">
</div>

<script>
  const params = new URLSearchParams(window.location.search);
  const nombreAutor = params.get("nombre");
  const contenedor = document.getElementById("autor-detalle");

  fetch("autores.json")
    .then(res => res.json())
    .then(data => {
      const autor = data.find(a => a.nombre === nombreAutor);

      if (!autor) {
        contenedor.innerHTML = "<p>Autor no encontrado.</p>";
        return;
      }

      let html = `
        <section class="autor-detalle">
          <img src="${autor.imagen}" alt="${autor.nombre}" class="autor-img">
          <h2>${autor.nombre}</h2>
          <p>${autor.biografia}</p>

          <div class="acciones-autor">
            <button class="btn btn-ver" id="btn-ver-imagen">Ver imagen</button>
          </div>

          <h3>Obras</h3>
          <ul>
      `;

      autor.obras.forEach(obra => {
        html += `
          <li class="obra-item">
            <div class="obra-info">
              <strong>${obra.titulo}</strong>
              <span class="genero">${obra.genero}</span>
            </div>

            <div class="obra-acciones">
              <a href="${obra.pdf}" target="_blank" rel="noopener" class="btn btn-ver">Ver</a>
              <a href="${obra.pdf}" download class="btn btn-descargar">Descargar</a>
            </div>
          </li>
        `;
      });

      html += "</ul></section>";
      contenedor.innerHTML = html;

      // ====== LÃ³gica del modal ======
      const modal = document.getElementById("modal-imagen");
      const modalImg = document.getElementById("modal-img");
      const btnVerImagen = document.getElementById("btn-ver-imagen");
      const cerrarModal = document.getElementById("cerrar-modal");

      btnVerImagen.addEventListener("click", () => {
        modal.style.display = "block";
        modalImg.src = autor.imagen;
        modalImg.alt = autor.nombre;
      });

      cerrarModal.addEventListener("click", () => {
        modal.style.display = "none";
      });

      // Cerrar al hacer click fuera de la imagen
      modal.addEventListener("click", (e) => {
        if (e.target === modal) {
          modal.style.display = "none";
        }
      });
    })
    .catch(() => {
      contenedor.innerHTML = "<p>Error al cargar el autor.</p>";
    });
</script>

</body>
</html>
